# Redis网络模型
==用户态,核心态==
>![[Pasted image 20231224102719.png]]

>![[Pasted image 20231224103033.png]]

# Linux 五种不同的IO模型

**阻塞式I/O模型**：应用程序发起I/O操作后会被阻塞，直到操作完成才能继续执行。
**非阻塞式I/O模型**：应用程序发起I/O操作后可以立即返回，不会被阻塞，但需要通过轮询或者事件通知来检查操作是否完成。
**I/O复用（select/poll）模型**：应用程序使用select或poll系统调用监视多个文件描述符，当其中任何一个准备好进行I/O操作时，应用程序才会进行实际的I/O操作。
**信号驱动I/O模型**：应用程序发起I/O操作后，可以继续执行其他任务，当I/O操作完成时，操作系统会向应用程序发送一个信号来通知完成。
**异步I/O模型**：应用程序发起I/O操作后可以立即返回，不会被阻塞，并且在操作完成后会得到通知，无需轮询或者阻塞等待。


## IO多路复用详解

在Linux系统中，==FD==通常指的是文件描述符（==file descriptor==）。文件描述符是一个非负整数，用来唯一标识一个正在被进程访问的文件或者I/O设备。当一个进程打开一个文件或者创建一个新的文件时，内核会为该文件分配一个文件描述符，并且在进程的文件描述符表中维护这个文件描述符。通过文件描述符，进程可以对文件进行读取、写入和其他操作。在Linux系统中，标准输入、标准输出和标准错误分别对应文件描述符0、1和2。

>![[Pasted image 20231224110651.png]]


**select：**
select是最古老的IO多路复用函数，它使用一个fd_set的数据结构来保存需要监视的文件描述符，但有个数限制，一般为1024。
每次调用select都需要将fd_set集合从用户态拷贝到内核态，性能较差。
在文件描述符较多时性能下降明显。
**poll：**
poll是对select的改进，没有文件描述符数量的限制。
使用pollfd结构来传递需要监视的文件描述符，不需要像select一样拷贝数据结构。
但是在文件描述符较多时，性能仍然会有一定下降。
**epoll：**
epoll是Linux特有的实现，性能优于select和poll。
使用事件驱动的方式，通过epoll_ctl注册文件描述符，然后通过epoll_wait等待事件发生。
不随着文件描述符数量的增加而降低性能，适合高并发的场景。

>![[Pasted image 20231224112300.png]]


>![[Pasted image 20231224135214.png]]


>![[Pasted image 20231224140913.png]]


>![[Pasted image 20231224140958.png]]

>![[Pasted image 20231224141850.png]]


>![[Pasted image 20231224142508.png]]


>![[Pasted image 20231224143450.png]]

# Rdis常见面试题

>![[Pasted image 20231224143812.png]]

>![[Pasted image 20231224143906.png]]


## Redis网络模型


>![[Pasted image 20231224144851.png]]

==在网络I/O方面,Redis使用多个I/O线程来处理网络请求和响应，以提高网络性能和吞吐量。这种设计允许Redis在处理大量客户端连接时能够更高效地进行网络通信.==

>![[Pasted image 20231224152402.png]]


# Redis通信协议RESP

>![[Pasted image 20231224153242.png]]

>![[Pasted image 20231224154323.png]]

# Redis内存回收


Redis有几种常见的内存回收策略，包括：

1. **定期删除**：定期删除过期的键来释放内存空间。
2. **惰性删除**：在获取键时检查是否过期，如果过期则删除。
3. **定期淘汰**：定期检查键的空转时间（idle time），并删除空转时间超过设定阈值的键。
4. **LRU淘汰**：Least Recently Used（LRU）算法，删除最近最少使用的键。
5. **LFU淘汰**：Least Frequently Used（LFU）算法，删除使用频率最低的键。

>![[Pasted image 20231224183700.png]]


>![[Pasted image 20231224184654.png]]

>![[Pasted image 20231224185330.png]]

>![[Pasted image 20231224185959.png]]

>![[Pasted image 20231224191148.png]]




























